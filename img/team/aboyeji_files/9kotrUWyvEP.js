/*!CK:460229570!*//*1438349993,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["LITx3"]); }

__d("MessengerContextBannerContainer.react",["AsyncRequest","DOMDimensions","immutable","MercuryIDs","MercuryParticipants","MercuryThreads","MessengerContextBanner.react","ReactComponentWithPureRenderMixin","React","StoreAndPropBasedStateMixin","XMessengerContextBannerController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();'use strict';var r=o,s=r.PropTypes,t=o.createClass({displayName:"MessengerContextBannerContainer",_asyncRequest:(null),mixins:[n,p(k,l)],propTypes:{location:s.string.isRequired,onResize:s.func,otherUserFBIDs:s.arrayOf(s.string),threadID:s.string,viewer:s.string.isRequired},statics:{calculateState:function(u){var v=null,w=null;if(u.threadID){v=l.getForFBID(u.viewer).getOrFetch(u.threadID);w=v&&v.participants;}else if(u.otherUserFBIDs&&u.otherUserFBIDs.length===1)w=u.otherUserFBIDs.map(function(z){return k.getIDFromVanityOrFBID(z);});var x=i.Map();if(w)x=x.withMutations(function(z){w&&w.forEach(function(aa){z.set(aa,k.getOrFetch(aa));});});var y=null;if(v){y=x.get(j.getParticipantIDFromFromThreadID(v.thread_id));}else y=w&&x.get(w[0]);return {contact:y,participantIDs:w,participants:x,thread:v};}},getInitialState:function(){return {connectionContext:'',contextItems:[]};},componentDidMount:function(){var u=(this.state.contact&&this.state.contact.fbid)||(this.props.otherUserFBIDs&&this.props.otherUserFBIDs[0]);if(u){var v=q.getURIBuilder().setInt('profile_id',u).getURI();this._asyncRequest=new g();this._asyncRequest&&this._asyncRequest.setAllowCrossPageTransition(true).setURI(v).setHandler(function(w){if(w&&w.payload)this.setState({connectionContext:w.payload.connection_context||'',contextItems:w.payload.context_items||[]},function(){var x=h.getElementDimensions(o.findDOMNode(this)).height;if(this.props.onResize)this.props.onResize(x);}.bind(this));}.bind(this)).send();}},componentWillUnmount:function(){if(this._asyncRequest){this._asyncRequest.abort();delete this._asyncRequest;}},render:function(){if(!this.state.contact||this.state.contact.type==='page')return null;return (o.createElement(m,{contactName:this.state.contact.name,connectionContext:this.state.connectionContext,contextItems:this.state.contextItems,location:this.props.location,participantIDs:this.state.participantIDs,participants:this.state.participants,style:this.props.style,thread:this.state.thread,viewer:this.props.viewer}));}});e.exports=t;},null);